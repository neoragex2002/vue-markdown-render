import{_ as s,c as e,o as a,ag as t}from"./chunks/framework.C0wiDQbp.js";const c=JSON.parse('{"title":"Performance Features & Tips","description":"","frontmatter":{},"headers":[],"relativePath":"guide/performance.md","filePath":"guide/performance.md"}'),n={name:"guide/performance.md"};function l(r,i,h,o,d,p){return a(),e("div",null,[...i[0]||(i[0]=[t(`<h1 id="performance-features-tips" tabindex="-1">Performance Features &amp; Tips <a class="header-anchor" href="#performance-features-tips" aria-label="Permalink to &quot;Performance Features &amp; Tips&quot;">​</a></h1><p>The renderer is optimized for streaming and large docs. Key features:</p><ul><li>Incremental parsing for code blocks</li><li>Efficient DOM updates and memory optimizations</li><li>Monaco streaming updates</li><li>Progressive Mermaid rendering</li></ul><p>Performance tips:</p><ul><li>Stream long documents in chunks</li><li>Use <code>MarkdownCodeBlockNode</code> or <code>renderCodeBlocksAsPre</code> for non-editable code</li><li>Scope custom components to enable GC</li><li>Use <code>setDefaultMathOptions</code> at bootstrap</li></ul><h2 id="keeping-a-steady-typewriter-style-stream" tabindex="-1">Keeping a Steady, Typewriter-Style Stream <a class="header-anchor" href="#keeping-a-steady-typewriter-style-stream" aria-label="Permalink to &quot;Keeping a Steady, Typewriter-Style Stream&quot;">​</a></h2><p>Some AI or LLM sources send content in large bursts, which can feel like the preview is freezing and then dumping a whole block. To keep the UI feeling like a smooth, continuous typewriter:</p><ul><li><strong>Keep <code>typewriter</code> enabled</strong> on <code>NodeRenderer</code> (default) so non-code nodes animate in character-by-character instead of appearing instantly.</li><li><strong>Tune the batching props</strong>: drop <code>initialRenderBatchSize</code>/<code>renderBatchSize</code> (for example <code>12</code>/<code>24</code>), and add a small <code>renderBatchDelay</code> (20–30 ms). Even if the model sends a huge chunk, the renderer then inserts tiny slices each frame, producing a stable flow.</li><li><strong>Throttle upstream updates</strong> if possible: instead of replacing <code>content</code> on every incoming hunk, debounce (50–100 ms) or split into smaller paragraphs so each render cycle operates on a “bite-sized” diff.</li><li><strong>Defer heavy nodes</strong> by keeping <code>deferNodesUntilVisible</code>/<code>viewportPriority</code> turned on; expensive blocks (Mermaid/Monaco) will wait until they are near the viewport so the stream of text is never blocked.</li><li><strong>Fall back for code blocks</strong> when a burst happens: disable <code>codeBlockStream</code> or temporarily use <code>renderCodeBlocksAsPre</code> during streaming so that syntax-highlighting work does not stall text updates.</li></ul><p>These knobs keep DOM work under a predictable budget, so users perceive a calm, steady flow of characters even when the backend sends data in erratic bursts.</p><p>Try this — tune rendering performance by enabling <code>viewportPriority</code>:</p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MarkdownRender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">md</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">viewport-priority</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre></div><h2 id="virtualization-dom-windows" tabindex="-1">Virtualization &amp; DOM windows <a class="header-anchor" href="#virtualization-dom-windows" aria-label="Permalink to &quot;Virtualization &amp; DOM windows&quot;">​</a></h2><p><code>NodeRenderer</code> keeps a moving window of nodes in memory so extremely long documents stay responsive:</p><ul><li><code>maxLiveNodes</code> (default <code>320</code>) caps how many fully rendered nodes remain in the DOM. Tune this based on your layout — lower values reduce memory but require slightly more placeholder churn; higher values prioritise scrollback.</li><li><code>liveNodeBuffer</code> controls overscan on both sides of the focus window (default <code>60</code>). Increase it when nodes vary wildly in height to avoid visible pop-in while scrolling fast.</li><li><code>deferNodesUntilVisible</code> together with <code>viewportPriority</code> defers mounting heavy nodes (Mermaid, Monaco, KaTeX) until an observer reports they are close to the viewport.</li><li><code>batchRendering</code>, <code>initialRenderBatchSize</code>, <code>renderBatchSize</code>, <code>renderBatchDelay</code>, and <code>renderBatchBudgetMs</code> govern how many nodes switch from placeholders to full components per frame. This incremental mode only runs when virtualization is disabled (<code>:max-live-nodes=&quot;0&quot;</code>); otherwise the virtual window already limits DOM work, so nodes are rendered immediately without placeholders.</li></ul><p>Example: Give the user a lighter DOM footprint while keeping scrollback smooth.</p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">MarkdownRender</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">md</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">max-live-nodes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">220</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">live-node-buffer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">batch-rendering</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">initial-render-batch-size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render-batch-size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">48</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render-batch-delay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render-batch-budget-ms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">defer-nodes-until-visible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">viewport-priority</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>With these knobs you can keep large AI transcripts or docs under a predictable CPU budget while still presenting consistent scroll behaviour.</p>`,17)])])}const g=s(n,[["render",l]]);export{c as __pageData,g as default};
