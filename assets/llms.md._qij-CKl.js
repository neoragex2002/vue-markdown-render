import{_ as o,c as i,o as d,ag as r}from"./chunks/framework.C0wiDQbp.js";const h=JSON.parse('{"title":"markstream-vue — Agent Context (/llms)","description":"","frontmatter":{},"headers":[],"relativePath":"llms.md","filePath":"llms.md"}'),l={name:"llms.md"};function a(t,e,s,n,c,m){return d(),i("div",null,[...e[0]||(e[0]=[r('<h1 id="markstream-vue-—-agent-context-llms" tabindex="-1">markstream-vue — Agent Context (<code>/llms</code>) <a class="header-anchor" href="#markstream-vue-—-agent-context-llms" aria-label="Permalink to &quot;markstream-vue — Agent Context (`/llms`)&quot;">​</a></h1><p>This file is a <strong>compact, agent-focused</strong> map of <code>markstream-vue</code>: where things live, how to answer common questions, and what to check first when users report issues.</p><h2 id="answering-guidelines" tabindex="-1">Answering guidelines <a class="header-anchor" href="#answering-guidelines" aria-label="Permalink to &quot;Answering guidelines&quot;">​</a></h2><ul><li>Prefer <strong>user-facing behavior</strong> from <code>docs/guide/*</code> (and <code>docs/zh/guide/*</code>) and <strong>export surface</strong> from <code>src/exports.ts</code>.</li><li>Ask <strong>at most one</strong> clarifying question if the request is ambiguous.</li><li>When debugging, ask for a <strong>minimal repro</strong> (there’s a shareable test page) and walk the user through the checklist below.</li><li>Avoid raw HTML tags like <code>&amp;lt;thinking&amp;gt;</code> in Markdown docs pages; escape them (VitePress compiles Markdown as Vue SFC).</li></ul><hr><h2 id="setup-commands" tabindex="-1">Setup commands <a class="header-anchor" href="#setup-commands" aria-label="Permalink to &quot;Setup commands&quot;">​</a></h2><ul><li>Install deps: <code>pnpm install</code></li><li>Playground dev: <code>pnpm dev</code></li><li>Docs dev/build/serve: <code>pnpm docs:dev</code>, <code>pnpm docs:build</code>, <code>pnpm docs:serve</code></li><li>Tests: <code>pnpm test</code></li><li>Typecheck: <code>pnpm typecheck</code></li><li>Lint: <code>pnpm lint</code></li></ul><hr><h2 id="repo-structure" tabindex="-1">Repo structure <a class="header-anchor" href="#repo-structure" aria-label="Permalink to &quot;Repo structure&quot;">​</a></h2><ul><li>Library source: <code>src/</code><ul><li>Public exports: <code>src/exports.ts</code></li><li>Components: <code>src/components/*/</code></li><li>Workers: <code>src/workers/</code></li><li>Utilities: <code>src/utils/</code>, <code>src/composables/</code>, <code>src/types/</code></li></ul></li><li>Parser-only package: <code>packages/markdown-parser/</code> (published as <code>stream-markdown-parser</code>)</li><li>Docs site (VitePress): <code>docs/</code> (Chinese under <code>docs/zh/</code>)</li><li>Demos: <code>playground/</code> (Vite), <code>playground-nuxt/</code> (Nuxt SSR)</li><li>Tests: <code>test/</code> (Vitest)</li></ul><hr><h2 id="core-mental-model" tabindex="-1">Core mental model <a class="header-anchor" href="#core-mental-model" aria-label="Permalink to &quot;Core mental model&quot;">​</a></h2><p>There are two layers:</p><ol><li><p><strong>Parser layer</strong> (<code>stream-markdown-parser</code>)</p><ul><li><code>getMarkdown()</code> creates a configured <code>markdown-it-ts</code> instance</li><li><code>parseMarkdownToStructure()</code> turns Markdown into a node tree (<code>ParsedNode[]</code>)</li><li>Streaming mid-states reduce flicker (unclosed fences / <code>$$</code> / partial inline HTML)</li></ul></li><li><p><strong>Renderer layer</strong> (<code>markstream-vue</code>)</p><ul><li>Default component: <code>MarkdownRender</code> (also referred to as <code>NodeRenderer</code>)</li><li>Takes either <code>content: string</code> (parses internally) or <code>nodes: ParsedNode[]</code> (recommended for streaming)</li><li>Performance tools: <ul><li>Virtualization window (<code>maxLiveNodes</code>, <code>liveNodeBuffer</code>)</li><li>Batch rendering (steady “typewriter” feel)</li><li>Defer heavy nodes until visible (<code>viewportPriority</code>, <code>deferNodesUntilVisible</code>)</li></ul></li></ul></li></ol><hr><h2 id="public-api-safe-to-suggest" tabindex="-1">Public API (safe to suggest) <a class="header-anchor" href="#public-api-safe-to-suggest" aria-label="Permalink to &quot;Public API (safe to suggest)&quot;">​</a></h2><p>From <code>markstream-vue</code> (<code>src/exports.ts</code>):</p><ul><li>Component: <code>MarkdownRender</code> (default export)</li><li>Parser helpers (re-exported): <code>getMarkdown()</code>, <code>parseMarkdownToStructure()</code>, <code>setDefaultMathOptions()</code></li><li>Custom node renderers: <code>setCustomComponents()</code>, <code>removeCustomComponents()</code>, <code>clearGlobalCustomComponents()</code></li><li>Feature toggles: <code>enableMermaid()</code>, <code>disableMermaid()</code>, <code>enableKatex()</code>, <code>disableKatex()</code></li><li>Worker injection: <ul><li>KaTeX: <code>createKaTeXWorkerFromCDN()</code>, <code>setKaTeXWorker()</code></li><li>Mermaid: <code>createMermaidWorkerFromCDN()</code>, <code>setMermaidWorker()</code></li></ul></li></ul><p>From <code>stream-markdown-parser</code> (<code>packages/markdown-parser/src/index.ts</code>):</p><ul><li><code>getMarkdown()</code>, <code>parseMarkdownToStructure()</code>, <code>ParseOptions</code> hooks</li><li>Streaming mid-state behavior and <code>final: true</code> end-of-stream mode</li></ul><hr><h2 id="troubleshooting-checklist-high-signal" tabindex="-1">Troubleshooting checklist (high signal) <a class="header-anchor" href="#troubleshooting-checklist-high-signal" aria-label="Permalink to &quot;Troubleshooting checklist (high signal)&quot;">​</a></h2><p>When “it doesn’t render” or “looks wrong”, check these in order:</p><ol><li><strong>CSS order/reset</strong>: reset first, then <code>markstream-vue/index.css</code> (Tailwind usually inside <code>@layer components</code>).</li><li><strong>Optional peer installed</strong> (Mermaid/KaTeX/Monaco/Shiki).</li><li><strong>Feature enabled</strong> where required: <code>enableMermaid()</code> / <code>enableKatex()</code>.</li><li><strong>Peer CSS imported</strong> where required: <code>katex/dist/katex.min.css</code>, <code>mermaid/dist/mermaid.css</code>.</li><li><strong>Standalone node wrapper</strong>: standalone node components need a <code>.markstream-vue</code> wrapper for scoped styles/vars.</li><li><strong>SSR</strong>: in Nuxt, wrap with <code>&amp;lt;client-only&amp;gt;</code> when using browser-only peers/workers.</li></ol><p>Docs: <code>docs/guide/troubleshooting.md</code>, <code>docs/guide/tailwind.md</code>, <code>docs/nuxt-ssr.md</code></p><hr><h2 id="common-intents-router" tabindex="-1">Common intents (router) <a class="header-anchor" href="#common-intents-router" aria-label="Permalink to &quot;Common intents (router)&quot;">​</a></h2><p>Use these as “answer skeletons”: quick steps + minimal repro questions + where to read next.</p><h3 id="install-first-render" tabindex="-1">Install + first render <a class="header-anchor" href="#install-first-render" aria-label="Permalink to &quot;Install + first render&quot;">​</a></h3><ul><li>Signals: “how to use”, “minimal example”</li><li>Steps: <ul><li>Import CSS: <code>markstream-vue/index.css</code></li><li>Render: <code>&amp;lt;MarkdownRender :content=&quot;md&quot; /&amp;gt;</code></li></ul></li><li>Ask: “Vite or Nuxt? Show your CSS import order (reset + Tailwind layers).”</li><li>Docs: <code>docs/guide/quick-start.md</code>, <code>docs/guide/installation.md</code></li></ul><h3 id="css-missing-tailwind-overrides" tabindex="-1">CSS missing / Tailwind overrides <a class="header-anchor" href="#css-missing-tailwind-overrides" aria-label="Permalink to &quot;CSS missing / Tailwind overrides&quot;">​</a></h3><ul><li>Signals: “unstyled”, “Tailwind overrides”, “looks wrong”</li><li>Steps: <ul><li>Ensure reset loads before <code>markstream-vue/index.css</code></li><li>Tailwind: import library CSS inside <code>@layer components</code></li><li>If using standalone node components, wrap <code>.markstream-vue</code></li></ul></li><li>Ask: “Paste <code>main.css</code> (Tailwind layers) + where you import <code>markstream-vue/index.css</code>.”</li><li>Docs: <code>docs/guide/tailwind.md</code>, <code>docs/guide/troubleshooting.md</code></li></ul><h3 id="streaming-loading-forever-at-end" tabindex="-1">Streaming: “loading forever” at end <a class="header-anchor" href="#streaming-loading-forever-at-end" aria-label="Permalink to &quot;Streaming: “loading forever” at end&quot;">​</a></h3><ul><li>Signals: “stuck loading”, “final chunk”</li><li>Steps: <ul><li>On end-of-stream set <code>final: true</code> (ParseOptions or component prop) so mid-states don’t stick</li></ul></li><li>Ask: “Do you set <code>final</code> when the stream ends? What are the last ~40 chars (often ends with ``` or $$)?”</li><li>Docs: <code>docs/guide/parser-api.md</code>, <code>docs/guide/parser.md</code></li></ul><h3 id="streaming-smooth-typewriter-feel" tabindex="-1">Streaming: smooth typewriter feel <a class="header-anchor" href="#streaming-smooth-typewriter-feel" aria-label="Permalink to &quot;Streaming: smooth typewriter feel&quot;">​</a></h3><ul><li>Signals: “bursty”, “jumpy”, “not smooth”</li><li>Steps: <ul><li>Enable/tune batching (<code>renderBatchSize</code> / <code>renderBatchDelay</code>)</li><li>Keep heavy nodes deferred (<code>viewportPriority</code>, <code>deferNodesUntilVisible</code>)</li></ul></li><li>Ask: “How often do you update <code>content/nodes</code> (per token? per chunk?) and what batch props are set?”</li><li>Docs: <code>docs/guide/performance.md</code>, <code>docs/guide/props.md</code></li></ul><h3 id="large-documents-perf-memory" tabindex="-1">Large documents: perf/memory <a class="header-anchor" href="#large-documents-perf-memory" aria-label="Permalink to &quot;Large documents: perf/memory&quot;">​</a></h3><ul><li>Signals: “huge markdown”, “scroll lag”, “memory high”</li><li>Steps: <ul><li>Tune virtualization (<code>maxLiveNodes</code>, <code>liveNodeBuffer</code>)</li><li>Keep heavy nodes deferred</li></ul></li><li>Ask: “Approx size (KB/lines)? Many code blocks/diagrams?”</li><li>Docs: <code>docs/guide/performance.md</code></li></ul><h3 id="mermaid-not-rendering" tabindex="-1">Mermaid not rendering <a class="header-anchor" href="#mermaid-not-rendering" aria-label="Permalink to &quot;Mermaid not rendering&quot;">​</a></h3><ul><li>Signals: “mermaid blank”</li><li>Steps: <ul><li>Install peer <code>mermaid</code></li><li>Call <code>enableMermaid()</code> on the client</li><li>Re-check CSS order/reset</li></ul></li><li>Ask: “Where do you call <code>enableMermaid()</code>? Any SSR? Is the fence ```mermaid?”</li><li>Docs: <code>docs/guide/mermaid.md</code>, <code>docs/guide/troubleshooting.md</code></li><li>Code: <code>src/components/MermaidBlockNode/mermaid.ts</code></li></ul><h3 id="katex-not-rendering" tabindex="-1">KaTeX not rendering <a class="header-anchor" href="#katex-not-rendering" aria-label="Permalink to &quot;KaTeX not rendering&quot;">​</a></h3><ul><li>Signals: “math not shown”</li><li>Steps: <ul><li>Install peer <code>katex</code></li><li>Import <code>katex/dist/katex.min.css</code></li><li>Call <code>enableKatex()</code> on the client</li></ul></li><li>Ask: “Is KaTeX CSS imported? <code>$...$</code> or <code>$$...$$</code>? Any SSR?”</li><li>Docs: <code>docs/guide/math.md</code>, <code>docs/guide/installation.md</code></li><li>Code: <code>src/components/MathInlineNode/katex.ts</code></li></ul><h3 id="monaco-code-blocks-missing-features-blank" tabindex="-1">Monaco code blocks missing features / blank <a class="header-anchor" href="#monaco-code-blocks-missing-features-blank" aria-label="Permalink to &quot;Monaco code blocks missing features / blank&quot;">​</a></h3><ul><li>Signals: “toolbar missing”, “blank editor”</li><li>Steps: <ul><li>Install peer <code>stream-monaco</code></li><li>Ensure Monaco workers are bundled (Vite plugin) and you’re on the client</li></ul></li><li>Ask: “Any worker-related console errors? Are Monaco workers bundled in production?”</li><li>Docs: <code>docs/guide/monaco.md</code>, <code>docs/guide/components.md</code></li></ul><h3 id="prefer-lightweight-code-blocks-no-monaco" tabindex="-1">Prefer lightweight code blocks (no Monaco) <a class="header-anchor" href="#prefer-lightweight-code-blocks-no-monaco" aria-label="Permalink to &quot;Prefer lightweight code blocks (no Monaco)&quot;">​</a></h3><ul><li>Signals: “SSR friendly”, “reduce bundle”</li><li>Steps: <ul><li>Use <code>MarkdownCodeBlockNode</code> (Shiki) or <code>render-code-blocks-as-pre</code></li><li>If using Shiki, install <code>shiki</code> + <code>stream-markdown</code></li></ul></li><li>Ask: “Need highlighting or just plain code?”</li><li>Docs: <code>docs/guide/code-blocks.md</code>, <code>docs/guide/components.md</code></li></ul><h3 id="custom-components-in-markdown-lt-thinking-gt" tabindex="-1">Custom components in Markdown (<code>&amp;lt;thinking&amp;gt;</code>) <a class="header-anchor" href="#custom-components-in-markdown-lt-thinking-gt" aria-label="Permalink to &quot;Custom components in Markdown (`&amp;lt;thinking&amp;gt;`)&quot;">​</a></h3><ul><li>Signals: “custom tag”, “embed component”</li><li>Steps: <ul><li>Allow tags via <code>customHtmlTags</code> / <code>custom-html-tags</code></li><li>Map via <code>setCustomComponents(customId, mapping)</code></li></ul></li><li>Ask: “What tag names? Do you want HTML passthrough or a custom node type?”</li><li>Docs: <code>docs/guide/advanced.md</code>, <code>docs/guide/parser-api.md</code></li></ul><h3 id="nuxt-ssr-errors" tabindex="-1">Nuxt SSR errors <a class="header-anchor" href="#nuxt-ssr-errors" aria-label="Permalink to &quot;Nuxt SSR errors&quot;">​</a></h3><ul><li>Signals: “window is not defined”, “SSR crash”</li><li>Steps: <ul><li>Wrap renderer in <code>&amp;lt;client-only&amp;gt;</code></li><li>Ensure heavy peers/workers initialize only in browser</li></ul></li><li>Ask: “Nuxt version? Error during build or runtime? Which peers are installed/enabled?”</li><li>Docs: <code>docs/nuxt-ssr.md</code></li></ul><h3 id="what-does-the-package-export" tabindex="-1">“What does the package export?” <a class="header-anchor" href="#what-does-the-package-export" aria-label="Permalink to &quot;“What does the package export?”&quot;">​</a></h3><ul><li>Signals: “is X exported”, “how to import Y”</li><li>Steps: <ul><li>Check <code>src/exports.ts</code> and <code>package.json#exports</code></li></ul></li><li>Ask: “Which symbol and what import path did you try?”</li><li>Docs: <code>docs/guide/components.md</code>, <code>docs/guide/api.md</code></li></ul>',52)])])}const p=o(l,[["render",a]]);export{h as __pageData,p as default};
