import{_ as o,c as d,o as i,ag as l}from"./chunks/framework.C0wiDQbp.js";const h=JSON.parse('{"title":"markstream-vue — Agent Context（中文）（/llms.zh-CN）","description":"","frontmatter":{},"headers":[],"relativePath":"llms.zh-CN.md","filePath":"llms.zh-CN.md"}'),c={name:"llms.zh-CN.md"};function a(r,e,t,s,n,m){return i(),d("div",null,[...e[0]||(e[0]=[l('<h1 id="markstream-vue-—-agent-context-中文-llms-zh-cn" tabindex="-1">markstream-vue — Agent Context（中文）（<code>/llms.zh-CN</code>） <a class="header-anchor" href="#markstream-vue-—-agent-context-中文-llms-zh-cn" aria-label="Permalink to &quot;markstream-vue — Agent Context（中文）（`/llms.zh-CN`）&quot;">​</a></h1><p>这个文件是给 AI/LLM/编码代理用的 <strong>项目地图</strong>：帮助快速定位“该看哪份文档/哪段源码”，以及常见问题的最短排错路径。</p><h2 id="回答原则" tabindex="-1">回答原则 <a class="header-anchor" href="#回答原则" aria-label="Permalink to &quot;回答原则&quot;">​</a></h2><ul><li>用户可见行为以 <code>docs/guide/*</code>（以及 <code>docs/zh/guide/*</code>）为准；“是否导出/怎么 import”以 <code>src/exports.ts</code> 为准。</li><li>问题不明确时最多问 <strong>1 个</strong>澄清问题，并给出默认建议。</li><li>排错优先走 checklist，并尽快要 <strong>最小复现</strong>（仓库有可分享 test page）。</li><li>文档页里避免写裸 <code>&amp;lt;thinking&amp;gt;</code> 这类标签；请用转义（VitePress 会把 Markdown 当 Vue SFC 编译）。</li></ul><hr><h2 id="常用命令" tabindex="-1">常用命令 <a class="header-anchor" href="#常用命令" aria-label="Permalink to &quot;常用命令&quot;">​</a></h2><ul><li>安装依赖：<code>pnpm install</code></li><li>Playground 开发：<code>pnpm dev</code></li><li>文档 dev/build/serve：<code>pnpm docs:dev</code> / <code>pnpm docs:build</code> / <code>pnpm docs:serve</code></li><li>测试：<code>pnpm test</code></li><li>类型检查：<code>pnpm typecheck</code></li><li>Lint：<code>pnpm lint</code></li></ul><hr><h2 id="仓库结构-去哪找" tabindex="-1">仓库结构（去哪找） <a class="header-anchor" href="#仓库结构-去哪找" aria-label="Permalink to &quot;仓库结构（去哪找）&quot;">​</a></h2><ul><li>库源码：<code>src/</code><ul><li>对外导出：<code>src/exports.ts</code></li><li>组件：<code>src/components/*/</code></li><li>Workers：<code>src/workers/</code></li><li>工具：<code>src/utils/</code>, <code>src/composables/</code>, <code>src/types/</code></li></ul></li><li>解析器包：<code>packages/markdown-parser/</code>（发布名：<code>stream-markdown-parser</code>）</li><li>文档站：<code>docs/</code>（中文：<code>docs/zh/</code>）</li><li>Demo：<code>playground/</code>（Vite），<code>playground-nuxt/</code>（Nuxt SSR）</li><li>测试：<code>test/</code>（Vitest）</li></ul><hr><h2 id="核心心智模型" tabindex="-1">核心心智模型 <a class="header-anchor" href="#核心心智模型" aria-label="Permalink to &quot;核心心智模型&quot;">​</a></h2><p>两层：</p><ol><li><p><strong>解析层</strong>（<code>stream-markdown-parser</code>）</p><ul><li><code>getMarkdown()</code>：创建并配置 <code>markdown-it-ts</code> 实例</li><li><code>parseMarkdownToStructure()</code>：Markdown → <code>ParsedNode[]</code></li><li>流式 mid-state：未闭合 fence / 未闭合 <code>$$</code> / 分段 inline HTML，减少闪烁</li></ul></li><li><p><strong>渲染层</strong>（<code>markstream-vue</code>）</p><ul><li>默认组件：<code>MarkdownRender</code>（文档里也常写 <code>NodeRenderer</code>）</li><li>输入：<code>content: string</code>（内部解析）或 <code>nodes: ParsedNode[]</code>（流式更推荐）</li><li>性能工具： <ul><li>虚拟化窗口（<code>maxLiveNodes</code>, <code>liveNodeBuffer</code>）</li><li>分批渲染（更平滑“打字机”体验）</li><li>重节点延迟渲染（<code>viewportPriority</code>, <code>deferNodesUntilVisible</code>）</li></ul></li></ul></li></ol><hr><h2 id="对外-api-可以放心建议" tabindex="-1">对外 API（可以放心建议） <a class="header-anchor" href="#对外-api-可以放心建议" aria-label="Permalink to &quot;对外 API（可以放心建议）&quot;">​</a></h2><p>来自 <code>markstream-vue</code>（<code>src/exports.ts</code>）：</p><ul><li>组件：<code>MarkdownRender</code>（默认导出）</li><li>解析辅助（re-export）：<code>getMarkdown()</code>, <code>parseMarkdownToStructure()</code>, <code>setDefaultMathOptions()</code></li><li>自定义节点映射：<code>setCustomComponents()</code>, <code>removeCustomComponents()</code>, <code>clearGlobalCustomComponents()</code></li><li>功能开关：<code>enableMermaid()</code>, <code>disableMermaid()</code>, <code>enableKatex()</code>, <code>disableKatex()</code></li><li>Worker 注入： <ul><li>KaTeX：<code>createKaTeXWorkerFromCDN()</code>, <code>setKaTeXWorker()</code></li><li>Mermaid：<code>createMermaidWorkerFromCDN()</code>, <code>setMermaidWorker()</code></li></ul></li></ul><p>来自 <code>stream-markdown-parser</code>（<code>packages/markdown-parser/src/index.ts</code>）：</p><ul><li><code>getMarkdown()</code>, <code>parseMarkdownToStructure()</code>, <code>ParseOptions</code> hooks</li><li>Streaming mid-state 与流结束 <code>final: true</code></li></ul><hr><h2 id="排错-checklist-高信号" tabindex="-1">排错 checklist（高信号） <a class="header-anchor" href="#排错-checklist-高信号" aria-label="Permalink to &quot;排错 checklist（高信号）&quot;">​</a></h2><p>遇到“不渲染/样式不对”，按顺序排：</p><ol><li><strong>CSS 顺序/Reset</strong>：先 reset，再 <code>markstream-vue/index.css</code>（Tailwind 通常放进 <code>@layer components</code>）。</li><li><strong>可选 peer 是否安装</strong>（Mermaid/KaTeX/Monaco/Shiki）。</li><li><strong>是否显式启用</strong>（需要时）：<code>enableMermaid()</code> / <code>enableKatex()</code>。</li><li><strong>peer CSS 是否导入</strong>（需要时）：<code>katex/dist/katex.min.css</code>, <code>mermaid/dist/mermaid.css</code>。</li><li><strong>单独节点组件 wrapper</strong>：单独用节点组件时，外层需要 <code>.markstream-vue</code>。</li><li><strong>SSR（Nuxt）</strong>：用 <code>&amp;lt;client-only&amp;gt;</code> 包裹，并确保重 peer/worker 仅浏览器初始化。</li></ol><p>文档：<code>docs/guide/troubleshooting.md</code>, <code>docs/guide/tailwind.md</code>, <code>docs/nuxt-ssr.md</code></p><hr><h2 id="常见意图-路由" tabindex="-1">常见意图（路由） <a class="header-anchor" href="#常见意图-路由" aria-label="Permalink to &quot;常见意图（路由）&quot;">​</a></h2><p>把用户问题归类到意图后，直接用“步骤 + 最小追问 + 指向文档/源码”。</p><h3 id="安装-跑通最小例子" tabindex="-1">安装 + 跑通最小例子 <a class="header-anchor" href="#安装-跑通最小例子" aria-label="Permalink to &quot;安装 + 跑通最小例子&quot;">​</a></h3><ul><li>表述： “怎么用”, “最小示例”</li><li>步骤： <ul><li>导入 CSS：<code>markstream-vue/index.css</code></li><li>渲染：<code>&amp;lt;MarkdownRender :content=&quot;md&quot; /&amp;gt;</code></li></ul></li><li>最小追问： “Vite 还是 Nuxt？贴一下 CSS 导入顺序（reset + Tailwind layers）。”</li><li>文档：<code>docs/guide/quick-start.md</code>, <code>docs/guide/installation.md</code></li></ul><h3 id="样式缺失-tailwind-覆盖" tabindex="-1">样式缺失 / Tailwind 覆盖 <a class="header-anchor" href="#样式缺失-tailwind-覆盖" aria-label="Permalink to &quot;样式缺失 / Tailwind 覆盖&quot;">​</a></h3><ul><li>表述： “没样式”, “Tailwind 抢样式”</li><li>步骤： <ul><li>reset 在前，<code>markstream-vue/index.css</code> 在后</li><li>Tailwind：把库 CSS 放进 <code>@layer components</code></li><li>单独节点组件：外层 <code>.markstream-vue</code></li></ul></li><li>最小追问： “贴 <code>main.css</code>（Tailwind layers）和 CSS 导入位置。”</li><li>文档：<code>docs/guide/tailwind.md</code>, <code>docs/guide/troubleshooting.md</code></li></ul><h3 id="流式-结束后卡-loading" tabindex="-1">流式：结束后卡 loading <a class="header-anchor" href="#流式-结束后卡-loading" aria-label="Permalink to &quot;流式：结束后卡 loading&quot;">​</a></h3><ul><li>表述： “最后卡住”, “loading 一直转”</li><li>步骤： <ul><li>流结束时设置 <code>final: true</code>（ParseOptions 或组件 prop），防止 mid-state 卡住</li></ul></li><li>最小追问： “你是否在 end-of-stream 设置了 <code>final</code>？最后一段是否以 ``` 或 $$ 结尾？”</li><li>文档：<code>docs/guide/parser-api.md</code>, <code>docs/guide/parser.md</code></li></ul><h3 id="流式-更平滑的打字机体验" tabindex="-1">流式：更平滑的打字机体验 <a class="header-anchor" href="#流式-更平滑的打字机体验" aria-label="Permalink to &quot;流式：更平滑的打字机体验&quot;">​</a></h3><ul><li>表述： “一坨一坨冒出来”, “不平滑”</li><li>步骤： <ul><li>调整 batch（<code>renderBatchSize</code> / <code>renderBatchDelay</code>）</li><li>保持重节点延迟（<code>viewportPriority</code>, <code>deferNodesUntilVisible</code>）</li></ul></li><li>最小追问： “你更新 <code>content/nodes</code> 的频率（每 token 还是每 chunk）？batch 参数是多少？”</li><li>文档：<code>docs/guide/performance.md</code>, <code>docs/guide/props.md</code></li></ul><h3 id="长文档-性能-内存" tabindex="-1">长文档：性能/内存 <a class="header-anchor" href="#长文档-性能-内存" aria-label="Permalink to &quot;长文档：性能/内存&quot;">​</a></h3><ul><li>表述： “长文卡”, “滚动掉帧”, “内存高”</li><li>步骤： <ul><li>调虚拟化（<code>maxLiveNodes</code>, <code>liveNodeBuffer</code>）</li><li>保持重节点延迟</li></ul></li><li>最小追问： “大概多长（KB/行数）？是否有很多代码块/图表？”</li><li>文档：<code>docs/guide/performance.md</code></li></ul><h3 id="mermaid-不显示" tabindex="-1">Mermaid 不显示 <a class="header-anchor" href="#mermaid-不显示" aria-label="Permalink to &quot;Mermaid 不显示&quot;">​</a></h3><ul><li>表述： “mermaid 空白”</li><li>步骤： <ul><li>安装 <code>mermaid</code> peer</li><li>客户端调用 <code>enableMermaid()</code></li><li>复查 CSS 顺序/reset</li></ul></li><li>最小追问： “你在哪调用 <code>enableMermaid()</code>？是否 SSR？fence 是否是 ```mermaid？”</li><li>文档：<code>docs/guide/mermaid.md</code>, <code>docs/guide/troubleshooting.md</code></li><li>源码：<code>src/components/MermaidBlockNode/mermaid.ts</code></li></ul><h3 id="katex-不显示" tabindex="-1">KaTeX 不显示 <a class="header-anchor" href="#katex-不显示" aria-label="Permalink to &quot;KaTeX 不显示&quot;">​</a></h3><ul><li>表述： “公式不渲染”</li><li>步骤： <ul><li>安装 <code>katex</code> peer</li><li>导入 <code>katex/dist/katex.min.css</code></li><li>客户端调用 <code>enableKatex()</code></li></ul></li><li>最小追问： “是否导入 KaTeX CSS？<code>$...$</code> 还是 <code>$$...$$</code>？是否 SSR？”</li><li>文档：<code>docs/guide/math.md</code>, <code>docs/guide/installation.md</code></li><li>源码：<code>src/components/MathInlineNode/katex.ts</code></li></ul><h3 id="monaco-代码块没功能-空白" tabindex="-1">Monaco 代码块没功能/空白 <a class="header-anchor" href="#monaco-代码块没功能-空白" aria-label="Permalink to &quot;Monaco 代码块没功能/空白&quot;">​</a></h3><ul><li>表述： “工具栏没了”, “编辑器空白”</li><li>步骤： <ul><li>安装 <code>stream-monaco</code> peer</li><li>确认 Monaco workers 已正确打包（Vite plugin），并确保只在浏览器端执行</li></ul></li><li>最小追问： “控制台是否有 worker/Monaco 报错？生产环境是否已打包 Monaco workers？”</li><li>文档：<code>docs/guide/monaco.md</code>, <code>docs/guide/components.md</code></li></ul><h3 id="想要轻量代码块-不装-monaco" tabindex="-1">想要轻量代码块（不装 Monaco） <a class="header-anchor" href="#想要轻量代码块-不装-monaco" aria-label="Permalink to &quot;想要轻量代码块（不装 Monaco）&quot;">​</a></h3><ul><li>表述： “SSR 友好”, “减包体”</li><li>步骤： <ul><li>用 <code>MarkdownCodeBlockNode</code>（Shiki）或开启 <code>render-code-blocks-as-pre</code></li><li>如果用 Shiki：安装 <code>shiki</code> + <code>stream-markdown</code></li></ul></li><li>最小追问： “需要语法高亮还是纯文本就行？”</li><li>文档：<code>docs/guide/code-blocks.md</code>, <code>docs/guide/components.md</code></li></ul><h3 id="markdown-里嵌自定义组件-lt-thinking-gt" tabindex="-1">Markdown 里嵌自定义组件（<code>&amp;lt;thinking&amp;gt;</code>） <a class="header-anchor" href="#markdown-里嵌自定义组件-lt-thinking-gt" aria-label="Permalink to &quot;Markdown 里嵌自定义组件（`&amp;lt;thinking&amp;gt;`）&quot;">​</a></h3><ul><li>表述： “自定义 tag”, “嵌组件”</li><li>步骤： <ul><li>通过 <code>customHtmlTags</code> / <code>custom-html-tags</code> 放行 tag</li><li>用 <code>setCustomComponents(customId, mapping)</code> 映射渲染</li></ul></li><li>最小追问： “tag 名称有哪些？希望按 HTML 透传还是自定义 node type？”</li><li>文档：<code>docs/guide/advanced.md</code>, <code>docs/guide/parser-api.md</code></li></ul><h3 id="nuxt-ssr-报错" tabindex="-1">Nuxt SSR 报错 <a class="header-anchor" href="#nuxt-ssr-报错" aria-label="Permalink to &quot;Nuxt SSR 报错&quot;">​</a></h3><ul><li>表述： “window is not defined”, “SSR crash”</li><li>步骤： <ul><li>用 <code>&amp;lt;client-only&amp;gt;</code> 包裹</li><li>Mermaid/Monaco/worker 仅浏览器初始化</li></ul></li><li>最小追问： “Nuxt 版本？报错发生在 build 还是 runtime？安装/启用了哪些 peers？”</li><li>文档：<code>docs/nuxt-ssr.md</code></li></ul><h3 id="想确认导出-怎么-import" tabindex="-1">想确认导出/怎么 import <a class="header-anchor" href="#想确认导出-怎么-import" aria-label="Permalink to &quot;想确认导出/怎么 import&quot;">​</a></h3><ul><li>表述： “是否导出 X”, “import 路径”</li><li>步骤： <ul><li>查 <code>src/exports.ts</code> 和 <code>package.json#exports</code></li></ul></li><li>最小追问： “要 import 的符号名是什么？现在用的 import 路径是什么？”</li><li>文档：<code>docs/guide/components.md</code>, <code>docs/guide/api.md</code></li></ul>',52)])])}const p=o(c,[["render",a]]);export{h as __pageData,p as default};
